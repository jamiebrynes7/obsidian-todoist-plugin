# Obsidian x Todoist Plugin

![GitHub Workflow Status](https://img.shields.io/github/workflow/status/jamiebrynes7/obsidian-todoist-plugin/premerge?style=for-the-badge) ![GitHub release (latest SemVer)](https://img.shields.io/github/v/release/jamiebrynes7/obsidian-todoist-plugin?style=for-the-badge)

An experimental [Obsidian](https://obsidian.md/) plugin using [Volcano](https://github.com/kognise/volcano) to materialize [Todoist](https://todoist.com/) task lists in Obsidian notes.

_Tested with Obsidian 0.8.9 and Volcano 1.2.1, your results may vary!_

![Example gif](./.github/obsidian-todoist-sync.gif)

## Usage

1. Download `todoist.js` from the [latest release](https://github.com/jamiebrynes7/obsidian-todoist-plugin/releases).
2. Place this into your `~/volcano/plugins` directory.
3. Copy your [Todoist API token](https://todoist.com/prefs/integrations) into `.obsidian/todoist-token`. (If you are synchronizing your vault, I recommend ignoring this file for safety reasons).
4. Open Obsidian and ensure that the Todoist plugin is enabled.
5. Place a code block like the following in any note:
   ````markdown
   ```todoist
   {
   "name": "My Tasks",
   "filter": "today | overdue"
   }
   ```
   ````
6. Swap to preview mode and the plugin should replace this code block with the materialized result of that filter.

## Inputs

| Name          | Required | Description                                                                                                       | Type     | Default |
| ------------- | :------: | ----------------------------------------------------------------------------------------------------------------- | -------- | ------- |
| `name`        |    ✓     | The title for the materialized query.                                                                             | string   |         |
| `filter`      |    ✓     | A valid [Todoist filter](https://get.todoist.help/hc/en-us/articles/205248842-Filters)<sup>[1](#footnote-1)</sup> | string   |         |
| `autorefresh` |          | The number of seconds between auto-refreshing. If omitted, the query use the default global settings.             | number   | null    |
| `sorting`     |          | Describes how to order the tasks in the query. Can be any of 'priority' or 'date', or multiple.                   | string[] | []      |

## Settings

This plugin adds a setting tab to the Obsidian settings menu. This controls global settings for this plugin.

| Name                  | What does it control?                                                                       | Default |
| --------------------- | ------------------------------------------------------------------------------------------- | ------- |
| Task fade animation   | Whether tasks should fade in and out when added or removed.                                 | true    |
| Auto-refresh          | Whether queries should auto-refresh at a set interval.                                      | false   |
| Auto-refresh interval | The interval (in seconds) that queries should auto-refresh by default. Integer numbers only | 60      |
| Render dates          | Whether dates should be rendered with tasks.                                                | true    |
| Render date icon      | Whether rendered dates should include an icon.                                              | true    |

## CSS

### General

There are a few CSS classes in the generated DOM, which you can use to customize the rendering of the list:

- `.todoist-query-title`: Attached to the header that contains the query title.
- `.todoist-refresh-button`: Attached to the refresh button.
- `.todoist-refresh-spin`: Attached to the refresh icon _when_ the plugin is refreshing the Todoist data.

My CSS for this in the demo above was:

```css
.todoist-query-title {
  display: inline;
}

.todoist-refresh-button {
  display: inline;
  margin-left: 8px;
}

.todoist-refresh-spin {
  animation: spin 1s linear infinite;
}

@-webkit-keyframes spin {
  100% {
    -webkit-transform: rotate(360deg);
  }
}
```

### Priority

Each task (`li` element) generated by the plugin will have a CSS class attached to it to represent that tasks priority. These classes are `todoist-p1`, `todoist-p2`, `todoist-p3`, and `todoist-p4`.

For example:

```css
.todoist-p1 > input[type="checkbox"] {
  /* This matches against the input element rendered for a priority 1 task. */
}
```

### Task Metadata

Task metadata (like date and project/section) are rendered under the task element in a `div` with class `task-metadata`. You can use this to configure the alignment / layout of these elements.

#### Dates

Any date will be rendered in a `div` element with the `task-date` class on it. Any tasks that are overdue will also have the `task-overdue` class attached to the `div`.

The icon rendered with the date has the `task-calendar-icon` class on it. I recommend using CSS to fix the size of the icon (depending on your existing styling). For example:

```css
.task-calendar-icon {
  vertical-align: middle;
  height: 17px;
  width: 17px;
}
```

There are also extra CSS classes associated with the `li` element relating to the date:

- `task-overdue` will be present on the `li` item.
- `has-time` or `has-no-time` will be present on the `li` item depending on if the task has a defined time.

#### Project & Section

Any project / section will be rendered in a `div` element with the `task-project` class on it.

The icon rendered with the date has the `task-project-icon` class on it. I recommend using CSS to fix the size of the icon (depending on your existing styling). For example:

```css
.task-project-icon {
  vertical-align: middle;
  height: 17px;
  width: 17px;
}
```

---

<a name="footnote-1">1</a>: There are some exceptions in the Todoist API. Checkout [this issue](https://github.com/jamiebrynes7/obsidian-todoist-plugin/issues/34) for details.
